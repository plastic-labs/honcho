"""update_induction_pattern_types

Revision ID: 645b106a7ed2
Revises: 2efcb031e5e7
Create Date: 2026-01-17 03:40:55.375828

"""
from collections.abc import Sequence

from alembic import op
import sqlalchemy as sa

from migrations.utils import get_schema

# revision identifiers, used by Alembic.
revision: str = '645b106a7ed2'
down_revision: str | None = '2efcb031e5e7'
branch_labels: str | Sequence[str] | None = None
depends_on: str | Sequence[str] | None = None

schema = get_schema()

def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint(op.f('fk_collections_workspace_name_workspaces'), 'collections', type_='foreignkey')
    op.drop_constraint(op.f('fk_collections_observer_workspace_name_peers'), 'collections', type_='foreignkey')
    op.drop_constraint(op.f('fk_collections_observed_workspace_name_peers'), 'collections', type_='foreignkey')
    op.create_foreign_key(op.f('fk_collections_observer_workspace_name_peers'), 'collections', 'peers', ['observer', 'workspace_name'], ['name', 'workspace_name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_collections_observed_workspace_name_peers'), 'collections', 'peers', ['observed', 'workspace_name'], ['name', 'workspace_name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_collections_workspace_name_workspaces'), 'collections', 'workspaces', ['workspace_name'], ['name'], source_schema='public', referent_schema='public')
    op.drop_constraint(op.f('fk_documents_observed_workspace_name_peers'), 'documents', type_='foreignkey')
    op.drop_constraint(op.f('fk_documents_workspace_name_workspaces'), 'documents', type_='foreignkey')
    op.drop_constraint(op.f('fk_documents_observer_observed_workspace_name_collections'), 'documents', type_='foreignkey')
    op.drop_constraint(op.f('fk_documents_observer_workspace_name_peers'), 'documents', type_='foreignkey')
    op.drop_constraint(op.f('fk_documents_session_name_workspace_name_sessions'), 'documents', type_='foreignkey')
    op.create_foreign_key(op.f('fk_documents_observed_workspace_name_peers'), 'documents', 'peers', ['observed', 'workspace_name'], ['name', 'workspace_name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_documents_observer_workspace_name_peers'), 'documents', 'peers', ['observer', 'workspace_name'], ['name', 'workspace_name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_documents_observer_observed_workspace_name_collections'), 'documents', 'collections', ['observer', 'observed', 'workspace_name'], ['observer', 'observed', 'workspace_name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_documents_session_name_workspace_name_sessions'), 'documents', 'sessions', ['session_name', 'workspace_name'], ['name', 'workspace_name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_documents_workspace_name_workspaces'), 'documents', 'workspaces', ['workspace_name'], ['name'], source_schema='public', referent_schema='public')
    op.drop_constraint(op.f('fk_falsification_traces_workspace_name_workspaces'), 'falsification_traces', type_='foreignkey')
    op.drop_constraint(op.f('fk_falsification_traces_prediction_id_predictions'), 'falsification_traces', type_='foreignkey')
    op.create_foreign_key(op.f('fk_falsification_traces_workspace_name_workspaces'), 'falsification_traces', 'workspaces', ['workspace_name'], ['name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_falsification_traces_prediction_id_predictions'), 'falsification_traces', 'predictions', ['prediction_id'], ['id'], source_schema='public', referent_schema='public')
    op.drop_constraint(op.f('fk_hypotheses_observer_observed_workspace_name_collections'), 'hypotheses', type_='foreignkey')
    op.drop_constraint(op.f('fk_hypotheses_observed_workspace_name_peers'), 'hypotheses', type_='foreignkey')
    op.drop_constraint(op.f('fk_hypotheses_observer_workspace_name_peers'), 'hypotheses', type_='foreignkey')
    op.drop_constraint(op.f('fk_hypotheses_workspace_name_workspaces'), 'hypotheses', type_='foreignkey')
    op.create_foreign_key(op.f('fk_hypotheses_observed_workspace_name_peers'), 'hypotheses', 'peers', ['observed', 'workspace_name'], ['name', 'workspace_name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_hypotheses_observer_observed_workspace_name_collections'), 'hypotheses', 'collections', ['observer', 'observed', 'workspace_name'], ['observer', 'observed', 'workspace_name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_hypotheses_workspace_name_workspaces'), 'hypotheses', 'workspaces', ['workspace_name'], ['name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_hypotheses_observer_workspace_name_peers'), 'hypotheses', 'peers', ['observer', 'workspace_name'], ['name', 'workspace_name'], source_schema='public', referent_schema='public')
    op.drop_constraint(op.f('fk_inductions_observer_workspace_name_peers'), 'inductions', type_='foreignkey')
    op.drop_constraint(op.f('fk_inductions_workspace_name_workspaces'), 'inductions', type_='foreignkey')
    op.drop_constraint(op.f('fk_inductions_observed_workspace_name_peers'), 'inductions', type_='foreignkey')
    op.drop_constraint(op.f('fk_inductions_observer_observed_workspace_name_collections'), 'inductions', type_='foreignkey')
    op.create_foreign_key(op.f('fk_inductions_observed_workspace_name_peers'), 'inductions', 'peers', ['observed', 'workspace_name'], ['name', 'workspace_name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_inductions_workspace_name_workspaces'), 'inductions', 'workspaces', ['workspace_name'], ['name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_inductions_observer_observed_workspace_name_collections'), 'inductions', 'collections', ['observer', 'observed', 'workspace_name'], ['observer', 'observed', 'workspace_name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_inductions_observer_workspace_name_peers'), 'inductions', 'peers', ['observer', 'workspace_name'], ['name', 'workspace_name'], source_schema='public', referent_schema='public')
    op.drop_constraint(op.f('fk_message_embeddings_workspace_name_workspaces'), 'message_embeddings', type_='foreignkey')
    op.drop_constraint(op.f('fk_message_embeddings_message_id_messages'), 'message_embeddings', type_='foreignkey')
    op.drop_constraint(op.f('fk_message_embeddings_peer_name_workspace_name_peers'), 'message_embeddings', type_='foreignkey')
    op.drop_constraint(op.f('fk_message_embeddings_session_name_workspace_name_sessions'), 'message_embeddings', type_='foreignkey')
    op.create_foreign_key(op.f('fk_message_embeddings_peer_name_workspace_name_peers'), 'message_embeddings', 'peers', ['peer_name', 'workspace_name'], ['name', 'workspace_name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_message_embeddings_message_id_messages'), 'message_embeddings', 'messages', ['message_id'], ['public_id'], source_schema='public', referent_schema='public', ondelete='CASCADE')
    op.create_foreign_key(op.f('fk_message_embeddings_workspace_name_workspaces'), 'message_embeddings', 'workspaces', ['workspace_name'], ['name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_message_embeddings_session_name_workspace_name_sessions'), 'message_embeddings', 'sessions', ['session_name', 'workspace_name'], ['name', 'workspace_name'], source_schema='public', referent_schema='public')
    op.drop_constraint(op.f('fk_messages_session_name_workspace_name_sessions'), 'messages', type_='foreignkey')
    op.drop_constraint(op.f('fk_messages_peer_name_workspace_name_peers'), 'messages', type_='foreignkey')
    op.create_foreign_key(op.f('fk_messages_session_name_workspace_name_sessions'), 'messages', 'sessions', ['session_name', 'workspace_name'], ['name', 'workspace_name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_messages_peer_name_workspace_name_peers'), 'messages', 'peers', ['peer_name', 'workspace_name'], ['name', 'workspace_name'], source_schema='public', referent_schema='public')
    op.drop_constraint(op.f('fk_peers_workspace_name_workspaces'), 'peers', type_='foreignkey')
    op.create_foreign_key(op.f('fk_peers_workspace_name_workspaces'), 'peers', 'workspaces', ['workspace_name'], ['name'], source_schema='public', referent_schema='public')
    op.drop_constraint(op.f('fk_predictions_workspace_name_workspaces'), 'predictions', type_='foreignkey')
    op.drop_constraint(op.f('fk_predictions_hypothesis_id_hypotheses'), 'predictions', type_='foreignkey')
    op.create_foreign_key(op.f('fk_predictions_workspace_name_workspaces'), 'predictions', 'workspaces', ['workspace_name'], ['name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_predictions_hypothesis_id_hypotheses'), 'predictions', 'hypotheses', ['hypothesis_id'], ['id'], source_schema='public', referent_schema='public')
    op.drop_constraint(op.f('fk_queue_workspace_name_workspaces'), 'queue', type_='foreignkey')
    op.drop_constraint(op.f('fk_queue_session_id_sessions'), 'queue', type_='foreignkey')
    op.drop_constraint(op.f('fk_queue_message_id_messages'), 'queue', type_='foreignkey')
    op.create_foreign_key(op.f('fk_queue_session_id_sessions'), 'queue', 'sessions', ['session_id'], ['id'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_queue_workspace_name_workspaces'), 'queue', 'workspaces', ['workspace_name'], ['name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_queue_message_id_messages'), 'queue', 'messages', ['message_id'], ['id'], source_schema='public', referent_schema='public')
    op.drop_constraint(op.f('fk_session_peers_workspace_name_workspaces'), 'session_peers', type_='foreignkey')
    op.drop_constraint(op.f('fk_session_peers_session_name_workspace_name_sessions'), 'session_peers', type_='foreignkey')
    op.drop_constraint(op.f('fk_session_peers_peer_name_workspace_name_peers'), 'session_peers', type_='foreignkey')
    op.create_foreign_key(op.f('fk_session_peers_peer_name_workspace_name_peers'), 'session_peers', 'peers', ['peer_name', 'workspace_name'], ['name', 'workspace_name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_session_peers_session_name_workspace_name_sessions'), 'session_peers', 'sessions', ['session_name', 'workspace_name'], ['name', 'workspace_name'], source_schema='public', referent_schema='public')
    op.create_foreign_key(op.f('fk_session_peers_workspace_name_workspaces'), 'session_peers', 'workspaces', ['workspace_name'], ['name'], source_schema='public', referent_schema='public')
    op.drop_constraint(op.f('fk_sessions_workspace_name_workspaces'), 'sessions', type_='foreignkey')
    op.create_foreign_key(op.f('fk_sessions_workspace_name_workspaces'), 'sessions', 'workspaces', ['workspace_name'], ['name'], source_schema='public', referent_schema='public')
    op.drop_constraint(op.f('fk_webhook_endpoints_workspace_name_workspaces'), 'webhook_endpoints', type_='foreignkey')
    op.create_foreign_key(op.f('fk_webhook_endpoints_workspace_name_workspaces'), 'webhook_endpoints', 'workspaces', ['workspace_name'], ['name'], source_schema='public', referent_schema='public')
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint(op.f('fk_webhook_endpoints_workspace_name_workspaces'), 'webhook_endpoints', schema='public', type_='foreignkey')
    op.create_foreign_key(op.f('fk_webhook_endpoints_workspace_name_workspaces'), 'webhook_endpoints', 'workspaces', ['workspace_name'], ['name'])
    op.drop_constraint(op.f('fk_sessions_workspace_name_workspaces'), 'sessions', schema='public', type_='foreignkey')
    op.create_foreign_key(op.f('fk_sessions_workspace_name_workspaces'), 'sessions', 'workspaces', ['workspace_name'], ['name'])
    op.drop_constraint(op.f('fk_session_peers_workspace_name_workspaces'), 'session_peers', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_session_peers_session_name_workspace_name_sessions'), 'session_peers', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_session_peers_peer_name_workspace_name_peers'), 'session_peers', schema='public', type_='foreignkey')
    op.create_foreign_key(op.f('fk_session_peers_peer_name_workspace_name_peers'), 'session_peers', 'peers', ['peer_name', 'workspace_name'], ['name', 'workspace_name'])
    op.create_foreign_key(op.f('fk_session_peers_session_name_workspace_name_sessions'), 'session_peers', 'sessions', ['session_name', 'workspace_name'], ['name', 'workspace_name'])
    op.create_foreign_key(op.f('fk_session_peers_workspace_name_workspaces'), 'session_peers', 'workspaces', ['workspace_name'], ['name'])
    op.drop_constraint(op.f('fk_queue_message_id_messages'), 'queue', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_queue_workspace_name_workspaces'), 'queue', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_queue_session_id_sessions'), 'queue', schema='public', type_='foreignkey')
    op.create_foreign_key(op.f('fk_queue_message_id_messages'), 'queue', 'messages', ['message_id'], ['id'])
    op.create_foreign_key(op.f('fk_queue_session_id_sessions'), 'queue', 'sessions', ['session_id'], ['id'])
    op.create_foreign_key(op.f('fk_queue_workspace_name_workspaces'), 'queue', 'workspaces', ['workspace_name'], ['name'])
    op.drop_constraint(op.f('fk_predictions_hypothesis_id_hypotheses'), 'predictions', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_predictions_workspace_name_workspaces'), 'predictions', schema='public', type_='foreignkey')
    op.create_foreign_key(op.f('fk_predictions_hypothesis_id_hypotheses'), 'predictions', 'hypotheses', ['hypothesis_id'], ['id'])
    op.create_foreign_key(op.f('fk_predictions_workspace_name_workspaces'), 'predictions', 'workspaces', ['workspace_name'], ['name'])
    op.drop_constraint(op.f('fk_peers_workspace_name_workspaces'), 'peers', schema='public', type_='foreignkey')
    op.create_foreign_key(op.f('fk_peers_workspace_name_workspaces'), 'peers', 'workspaces', ['workspace_name'], ['name'])
    op.drop_constraint(op.f('fk_messages_peer_name_workspace_name_peers'), 'messages', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_messages_session_name_workspace_name_sessions'), 'messages', schema='public', type_='foreignkey')
    op.create_foreign_key(op.f('fk_messages_peer_name_workspace_name_peers'), 'messages', 'peers', ['peer_name', 'workspace_name'], ['name', 'workspace_name'])
    op.create_foreign_key(op.f('fk_messages_session_name_workspace_name_sessions'), 'messages', 'sessions', ['session_name', 'workspace_name'], ['name', 'workspace_name'])
    op.drop_constraint(op.f('fk_message_embeddings_session_name_workspace_name_sessions'), 'message_embeddings', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_message_embeddings_workspace_name_workspaces'), 'message_embeddings', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_message_embeddings_message_id_messages'), 'message_embeddings', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_message_embeddings_peer_name_workspace_name_peers'), 'message_embeddings', schema='public', type_='foreignkey')
    op.create_foreign_key(op.f('fk_message_embeddings_session_name_workspace_name_sessions'), 'message_embeddings', 'sessions', ['session_name', 'workspace_name'], ['name', 'workspace_name'])
    op.create_foreign_key(op.f('fk_message_embeddings_peer_name_workspace_name_peers'), 'message_embeddings', 'peers', ['peer_name', 'workspace_name'], ['name', 'workspace_name'])
    op.create_foreign_key(op.f('fk_message_embeddings_message_id_messages'), 'message_embeddings', 'messages', ['message_id'], ['public_id'], ondelete='CASCADE')
    op.create_foreign_key(op.f('fk_message_embeddings_workspace_name_workspaces'), 'message_embeddings', 'workspaces', ['workspace_name'], ['name'])
    op.drop_constraint(op.f('fk_inductions_observer_workspace_name_peers'), 'inductions', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_inductions_observer_observed_workspace_name_collections'), 'inductions', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_inductions_workspace_name_workspaces'), 'inductions', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_inductions_observed_workspace_name_peers'), 'inductions', schema='public', type_='foreignkey')
    op.create_foreign_key(op.f('fk_inductions_observer_observed_workspace_name_collections'), 'inductions', 'collections', ['observer', 'observed', 'workspace_name'], ['observer', 'observed', 'workspace_name'])
    op.create_foreign_key(op.f('fk_inductions_observed_workspace_name_peers'), 'inductions', 'peers', ['observed', 'workspace_name'], ['name', 'workspace_name'])
    op.create_foreign_key(op.f('fk_inductions_workspace_name_workspaces'), 'inductions', 'workspaces', ['workspace_name'], ['name'])
    op.create_foreign_key(op.f('fk_inductions_observer_workspace_name_peers'), 'inductions', 'peers', ['observer', 'workspace_name'], ['name', 'workspace_name'])
    op.drop_constraint(op.f('fk_hypotheses_observer_workspace_name_peers'), 'hypotheses', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_hypotheses_workspace_name_workspaces'), 'hypotheses', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_hypotheses_observer_observed_workspace_name_collections'), 'hypotheses', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_hypotheses_observed_workspace_name_peers'), 'hypotheses', schema='public', type_='foreignkey')
    op.create_foreign_key(op.f('fk_hypotheses_workspace_name_workspaces'), 'hypotheses', 'workspaces', ['workspace_name'], ['name'])
    op.create_foreign_key(op.f('fk_hypotheses_observer_workspace_name_peers'), 'hypotheses', 'peers', ['observer', 'workspace_name'], ['name', 'workspace_name'])
    op.create_foreign_key(op.f('fk_hypotheses_observed_workspace_name_peers'), 'hypotheses', 'peers', ['observed', 'workspace_name'], ['name', 'workspace_name'])
    op.create_foreign_key(op.f('fk_hypotheses_observer_observed_workspace_name_collections'), 'hypotheses', 'collections', ['observer', 'observed', 'workspace_name'], ['observer', 'observed', 'workspace_name'])
    op.drop_constraint(op.f('fk_falsification_traces_prediction_id_predictions'), 'falsification_traces', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_falsification_traces_workspace_name_workspaces'), 'falsification_traces', schema='public', type_='foreignkey')
    op.create_foreign_key(op.f('fk_falsification_traces_prediction_id_predictions'), 'falsification_traces', 'predictions', ['prediction_id'], ['id'])
    op.create_foreign_key(op.f('fk_falsification_traces_workspace_name_workspaces'), 'falsification_traces', 'workspaces', ['workspace_name'], ['name'])
    op.drop_constraint(op.f('fk_documents_workspace_name_workspaces'), 'documents', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_documents_session_name_workspace_name_sessions'), 'documents', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_documents_observer_observed_workspace_name_collections'), 'documents', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_documents_observer_workspace_name_peers'), 'documents', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_documents_observed_workspace_name_peers'), 'documents', schema='public', type_='foreignkey')
    op.create_foreign_key(op.f('fk_documents_session_name_workspace_name_sessions'), 'documents', 'sessions', ['session_name', 'workspace_name'], ['name', 'workspace_name'])
    op.create_foreign_key(op.f('fk_documents_observer_workspace_name_peers'), 'documents', 'peers', ['observer', 'workspace_name'], ['name', 'workspace_name'])
    op.create_foreign_key(op.f('fk_documents_observer_observed_workspace_name_collections'), 'documents', 'collections', ['observer', 'observed', 'workspace_name'], ['observer', 'observed', 'workspace_name'])
    op.create_foreign_key(op.f('fk_documents_workspace_name_workspaces'), 'documents', 'workspaces', ['workspace_name'], ['name'])
    op.create_foreign_key(op.f('fk_documents_observed_workspace_name_peers'), 'documents', 'peers', ['observed', 'workspace_name'], ['name', 'workspace_name'])
    op.drop_constraint(op.f('fk_collections_workspace_name_workspaces'), 'collections', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_collections_observed_workspace_name_peers'), 'collections', schema='public', type_='foreignkey')
    op.drop_constraint(op.f('fk_collections_observer_workspace_name_peers'), 'collections', schema='public', type_='foreignkey')
    op.create_foreign_key(op.f('fk_collections_observed_workspace_name_peers'), 'collections', 'peers', ['observed', 'workspace_name'], ['name', 'workspace_name'])
    op.create_foreign_key(op.f('fk_collections_observer_workspace_name_peers'), 'collections', 'peers', ['observer', 'workspace_name'], ['name', 'workspace_name'])
    op.create_foreign_key(op.f('fk_collections_workspace_name_workspaces'), 'collections', 'workspaces', ['workspace_name'], ['name'])
    # ### end Alembic commands ###
